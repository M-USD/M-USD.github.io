<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>ðŸ“±M-USD</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></head><body><div class="app-header"><div class="container"><div class="logo"><i class="fas fa-money-bill-wave logo-icon"></i><h1>ðŸ‡ºðŸ‡¸M-USD</h1></div></div></div><div class="container"><div id="auth-screen" class="card"><h2>Welcome to M-USD</h2><p>Please login or register to continue</p><div class="nav-tabs"><div class="nav-tab active" id="login-tab">Login</div><div class="nav-tab" id="register-tab">Register</div></div><div id="login-form"><div class="form-group"><label for="login-phone">Phone Number</label><input type="tel" id="login-phone" class="form-control" placeholder="07XXXXXXXX"></div><div class="form-group"><label for="login-pin">PIN</label><input type="password" id="login-pin" class="form-control" placeholder="4-digit PIN" maxlength="4"></div><button class="btn btn-primary" id="login-btn">Login</button></div><div id="register-form" class="hidden"><div class="form-group"><label for="register-phone">Phone Number</label><input type="tel" id="register-phone" class="form-control" placeholder="07XXXXXXXX"></div><div class="form-group"><label for="register-pin">Create PIN</label><input type="password" id="register-pin" class="form-control" placeholder="4-digit PIN" maxlength="4"></div><div class="form-group"><label for="confirm-pin">Confirm PIN</label><input type="password" id="confirm-pin" class="form-control" placeholder="Confirm PIN" maxlength="4"></div><button class="btn btn-primary" id="register-btn">Register</button></div></div><div id="dashboard-screen" class="hidden"><div class="balance-card"><p>Your Balance</p><div class="balance-amount" id="user-balance">USD 0.00</div><p id="user-phone"></p></div><div class="menu-grid"><div class="menu-item" id="deposit-btn"><div class="menu-icon"><i class="fas fa-money-bill-wave"></i></div><div>Deposit</div></div><div class="menu-item" id="send-money-btn"><div class="menu-icon"><i class="fas fa-paper-plane"></i></div><div>Send Money</div></div><div class="menu-item" id="transactions-btn"><div class="menu-icon"><i class="fas fa-history"></i></div><div>Transactions</div></div><div class="menu-item" id="admin-btn"><div class="menu-icon"><i class="fas fa-cog"></i></div><div>Admin</div></div></div><button class="btn btn-outline" id="logout-btn">Logout</button></div><div id="deposit-screen" class="card hidden"><h2>Deposit Funds</h2><div class="form-group"><label for="deposit-amount">You can ask your Friends to send you USD</label></div><button class="btn btn-primary" id="confirm-deposit">Whatsapp +254746500025 to buy USD</button><button class="btn btn-outline" id="back-from-deposit">Back</button></div><div id="send-money-screen" class="card hidden"><h2>Send Money</h2><div class="form-group"><label for="recipient-phone">Recipient Phone Number</label><input type="tel" id="recipient-phone" class="form-control" placeholder="07XXXXXXXX"></div><div class="form-group"><label for="send-amount">Amount (USD)</label><input type="number" id="send-amount" class="form-control" placeholder="Enter amount"></div><div class="form-group"><p>Transaction Fee (1%): <span id="transaction-fee">USD 0.00</span></p><p>Total Deducted: <span id="total-deducted">USD 0.00</span></p></div><button class="btn btn-primary" id="confirm-send">Send Money</button><button class="btn btn-outline" id="back-from-send">Back</button></div><div id="transactions-screen" class="card hidden"><h2>Transaction History</h2><div id="transactions-list"></div><button class="btn btn-outline" id="back-from-transactions">Back</button></div><div id="admin-panel" class="admin-panel hidden"><h2>Admin Panel</h2><div class="admin-section"><h3>All Users</h3><div id="users-list"></div></div><div class="admin-section"><h3>All Transactions</h3><div id="admin-transactions-list"></div></div><button class="btn btn-outline" id="back-from-admin">Back to Dashboard</button></div><div id="loading-screen" class="card hidden"><div class="loading"><div class="spinner"></div><p>Loading...</p></div></div></div><div id="notification" class="notification"></div><div class="footer"><p>ðŸ‡ºðŸ‡¸M-USD &copy; 2026 | Transparentâ€¢Simpleâ€¢Honest</p></div>
<script type="module">import{initializeApp as a}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";import{getDatabase as b,ref as c,set as d,get as e,push as f,update as g,query as h,orderByChild as i,onValue as j}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";const K={apiKey:"AIzaSyDfP7BSZB7kufh4yrSdpDn14kIdbF9SJdc",authDomain:"m-usd-e3555.firebaseapp.com",databaseURL:"https://m-usd-e3555-default-rtdb.firebaseio.com",projectId:"m-usd-e3555",storageBucket:"m-usd-e3555.firebasestorage.app",messagingSenderId:"966918203590",appId:"1:966918203590:web:b19913384b906a472d0fc7",measurementId:"G-Y3X5T8GSNC"};const L=a(K),M=b(L);let U=[],T=[],CUSER=null;const $=(id)=>document.getElementById(id);const AUTH=$('auth-screen'),DASH=$('dashboard-screen'),DEP=$('deposit-screen'),SEND=$('send-money-screen'),TRAN=$('transactions-screen'),ADMIN=$('admin-panel'),LOAD=$('loading-screen'),NOTIF=$('notification');const BTN={login:$('login-btn'),reg:$('register-btn'),logout:$('logout-btn'),dep:$('deposit-btn'),send:$('send-money-btn'),tx:$('transactions-btn'),adm:$('admin-btn'),confDep:$('confirm-deposit'),confSend:$('confirm-send'),backDep:$('back-from-deposit'),backSend:$('back-from-send'),backTx:$('back-from-transactions'),backAdm:$('back-from-admin')};const ELS={bal:$('user-balance'),phone:$('user-phone'),txList:$('transactions-list'),usersList:$('users-list'),adminTxList:$('admin-transactions-list'),sendAmt:$('send-amount'),rec:$('recipient-phone'),fee:$('transaction-fee'),total:$('total-deducted')};const hideAll=()=>{[AUTH,DASH,DEP,SEND,TRAN,ADMIN,LOAD].forEach(x=>x.classList.add('hidden'))};const show=(el)=>{hideAll();el.classList.remove('hidden')};const showLoad=()=>{hideAll();LOAD.classList.remove('hidden')};async function lu(){try{const r=c(M,'users');const s=await e(r);U=[];if(s.exists()){const dat=s.val();Object.keys(dat).forEach(k=>U.push({id:k,...dat[k]}))}return U}catch(err){showNotif('Error loading users','error');return[]}}async function lt(){try{const r=c(M,'transactions');const s=await e(r);T=[];if(s.exists()){const dat=s.val();Object.keys(dat).forEach(k=>T.push({id:k,...dat[k]}));T.sort((a,b)=>new Date(b.date)-new Date(a.date))}return T}catch(err){showNotif('Error loading transactions','error');return[]}}async function su(u){try{if(u.id){await g(c(M,'users/'+u.id),u)}else{const R=f(c(M,'users'));u.id=R.key;await d(R,u)}return u}catch(err){showNotif('Error saving user data','error');return null}}async function st(tx){try{const R=f(c(M,'transactions'));tx.id=R.key;await d(R,tx);return tx}catch(err){showNotif('Error saving transaction','error');return null}}function showNotif(msg,typ='info'){NOTIF.textContent=msg;NOTIF.className=`notification ${typ} show`;setTimeout(()=>NOTIF.classList.remove('show'),3e3)}function updDash(){if(!CUSER)return;ELS.bal.textContent=`USD ${CUSER.balance.toFixed(2)}`;ELS.phone.textContent=CUSER.phone;$('admin-btn').style.display=CUSER.isAdmin?'block':'none'}function updTxDetails(){const a=parseFloat(ELS.sendAmt.value)||0;const f1=a*0.01;const tot=a+f1;ELS.fee.textContent=`USD ${f1.toFixed(2)}`;ELS.total.textContent=`USD ${tot.toFixed(2)}`}document.getElementById('login-tab').addEventListener('click',()=>{document.getElementById('login-tab').classList.add('active');document.getElementById('register-tab').classList.remove('active');$('login-form').classList.remove('hidden');$('register-form').classList.add('hidden')});document.getElementById('register-tab').addEventListener('click',()=>{document.getElementById('register-tab').classList.add('active');document.getElementById('login-tab').classList.remove('active');$('register-form').classList.remove('hidden');$('login-form').classList.add('hidden')});BTN.login.addEventListener('click',async()=>{const ph=$('login-phone').value;const pin=$('login-pin').value;if(!ph||!pin){showNotif('Please enter phone number and PIN','error');return}showLoad();try{await lu();const u=U.find(x=>x.phone===ph&&x.pin===pin);if(!u){showNotif('Invalid phone number or PIN','error');show(AUTH);return}if(u.isSuspended||u.isBlocked){showNotif(u.isSuspended?'Your account has been suspended. Contact support.':'Your account has been blocked. Contact support.','error');show(AUTH);return}CUSER=u;updDash();show(DASH);showNotif('Login successful!','success')}catch(err){showNotif('Login failed. Please try again.','error');show(AUTH)}});BTN.reg.addEventListener('click',async()=>{const ph=$('register-phone').value;const pin=$('register-pin').value;const cp=$('confirm-pin').value;if(!ph||!pin||!cp){showNotif('Please fill all fields','error');return}if(pin!==cp){showNotif('PINs do not match','error');return}if(pin.length!==4){showNotif('PIN must be 4 digits','error');return}showLoad();try{await lu();if(U.find(x=>x.phone===ph)){showNotif('Phone number already registered','error');show(AUTH);return}const nu={phone:ph,pin:pin,balance:0,isAdmin:false,isSuspended:false,isBlocked:false,dateCreated:new Date().toISOString()};const s=await su(nu);if(s){U.push(s);showNotif('Registration successful! Please login.','success');document.getElementById('login-tab').click();show(AUTH);$('register-phone').value='';$('register-pin').value='';$('confirm-pin').value=''} }catch(err){showNotif('Registration failed. Please try again.','error');show(AUTH)}});BTN.logout.addEventListener('click',()=>{CUSER=null;show(AUTH);showNotif('Logged out successfully','info')});$('deposit-btn').addEventListener('click',()=>{show(DEP);const el=document.getElementById('deposit-amount');if(el)el.value=''});$('confirm-deposit').addEventListener('click',async()=>{const amt=parseFloat((document.getElementById('deposit-amount')||{value:0}).value);if(!amt||amt<=0){showNotif('Please enter a valid amount','error');return}showLoad();try{CUSER.balance+=amt;await su(CUSER);await st({from:'DEPOSIT',to:CUSER.phone,amount:amt,fee:0,type:'deposit',date:new Date().toISOString()});await lu();await lt();CUSER=U.find(u=>u.id===CUSER.id);updDash();show(DASH);showNotif(`Deposit of USD ${amt.toFixed(2)} successful!`,'success')}catch(err){showNotif('Deposit failed. Please try again.','error');show(DASH)}});$('send-money-btn').addEventListener('click',()=>{show(SEND);$('recipient-phone').value='';$('send-amount').value='';updTxDetails()});$('send-amount').addEventListener('input',updTxDetails);$('recipient-phone').addEventListener('input',updTxDetails);$('confirm-send').addEventListener('click',async()=>{const recipient=$('recipient-phone').value;const amount=parseFloat($('send-amount').value);if(!recipient||!amount||amount<=0){showNotif('Please enter valid recipient and amount','error');return}if(recipient===CUSER.phone){showNotif('Cannot send money to yourself','error');return}showLoad();try{await lu();const rU=U.find(u=>u.phone===recipient);if(!rU){showNotif('Recipient not found','error');show(DASH);return}if(rU.isSuspended||rU.isBlocked){showNotif('Recipient account is not active','error');show(DASH);return}const fee=amount*0.01;const total=amount+fee;if(CUSER.balance<total){showNotif('Insufficient balance','error');show(DASH);return}CUSER.balance-=total;rU.balance+=amount;const adminUser=U.find(u=>u.isAdmin);if(adminUser){adminUser.balance+=fee;await su(adminUser)}await su(CUSER);await su(rU);await st({from:CUSER.phone,to:recipient,amount:amount,fee:fee,type:'send',date:new Date().toISOString()});await lu();await lt();CUSER=U.find(u=>u.id===CUSER.id);updDash();show(DASH);showNotif(`Sent USD ${amount.toFixed(2)} to ${recipient}`,'success')}catch(err){showNotif('Transaction failed. Please try again.','error');show(DASH)}});$('transactions-btn').addEventListener('click',async()=>{show(TRAN);await displayUserTransactions()});async function displayUserTransactions(){if(!CUSER)return;await lt();const my=T.filter(t=>t.from===CUSER.phone||t.to===CUSER.phone);ELS.txList.innerHTML='';if(my.length===0){ELS.txList.innerHTML='<p>No transactions found</p>';return}my.forEach(tr=>{const el=document.createElement('div');el.className='transaction-item';const isSent=tr.from===CUSER.phone;const cls=isSent?'transaction-negative':'transaction-positive';const pref=isSent?'-':'+';el.innerHTML=`<div class="transaction-details"><div>${isSent?`To: ${tr.to}`:`From: ${tr.from}`}</div><div class="transaction-date">${new Date(tr.date).toLocaleString()}</div>${tr.fee>0?`<div class="transaction-fee">Fee: USD ${tr.fee.toFixed(2)}</div>`:''}</div><div class="transaction-amount ${cls}">${pref}USD ${tr.amount.toFixed(2)}</div>`;ELS.txList.appendChild(el)})}$('admin-btn').addEventListener('click',async()=>{if(!CUSER||!CUSER.isAdmin){showNotif('Access denied','error');return}show(ADMIN);await dispUsers();await dispTxs()});async function dispUsers(){await lu();ELS.usersList.innerHTML='';U.forEach(u=>{if(u.isAdmin)return;const el=document.createElement('div');el.className='user-item';let sc='status-active',st='Active';if(u.isBlocked){sc='status-blocked';st='Blocked'}else if(u.isSuspended){sc='status-suspended';st='Suspended'}el.innerHTML=`<div><div>${u.phone}</div><div>Balance: USD ${u.balance.toFixed(2)}</div><div>Registered: ${new Date(u.dateCreated).toLocaleDateString()}</div></div><div><span class="status-badge ${sc}">${st}</span><div class="user-actions"><button class="action-btn suspend" data-phone="${u.phone}">Suspend</button><button class="action-btn block" data-phone="${u.phone}">Block</button><button class="action-btn recover" data-phone="${u.phone}">Recover Funds</button></div></div>`;ELS.usersList.appendChild(el)});document.querySelectorAll('.action-btn.suspend').forEach(b=>b.addEventListener('click',()=>handleSuspend(b.dataset.phone)));document.querySelectorAll('.action-btn.block').forEach(b=>b.addEventListener('click',()=>handleBlock(b.dataset.phone)));document.querySelectorAll('.action-btn.recover').forEach(b=>b.addEventListener('click',()=>handleRecover(b.dataset.phone)))}async function dispTxs(){await lt();ELS.adminTxList.innerHTML='';if(T.length===0){ELS.adminTxList.innerHTML='<p>No transactions found</p>';return}T.forEach(tr=>{const el=document.createElement('div');el.className='transaction-admin-item';el.innerHTML=`<div><div>From: ${tr.from} â†’ To: ${tr.to}</div><div>Date: ${new Date(tr.date).toLocaleString()}</div><div>Type: ${tr.type}</div></div><div><div>Amount: USD ${tr.amount.toFixed(2)}</div>${tr.fee>0?`<div>Fee: USD ${tr.fee.toFixed(2)}</div>`:''}</div>`;ELS.adminTxList.appendChild(el)})}async function handleSuspend(phone){const u=U.find(x=>x.phone===phone);if(u){u.isSuspended=!u.isSuspended;u.isBlocked=false;await su(u);await dispUsers();showNotif(`User ${u.isSuspended?'suspended':'activated'}`,'info')}}async function handleBlock(phone){const u=U.find(x=>x.phone===phone);if(u){u.isBlocked=!u.isBlocked;u.isSuspended=false;await su(u);await dispUsers();showNotif(`User ${u.isBlocked?'blocked':'activated'}`,'info')}}async function handleRecover(phone){const u=U.find(x=>x.phone===phone);if(u&&u.balance>0){const amt=u.balance;const adminU=U.find(x=>x.isAdmin);if(adminU){adminU.balance+=amt;await su(adminU)}await st({from:u.phone,to:'ADMIN',amount:amt,fee:0,type:'recovery',date:new Date().toISOString()});u.balance=0;await su(u);await dispUsers();await dispTxs();showNotif(`Recovered USD ${amt.toFixed(2)} from ${u.phone}`,'success')}else showNotif('No funds to recover','info')}document.addEventListener('DOMContentLoaded',async()=>{show(AUTH);try{await lu();const adm=U.find(u=>u.phone==='0700000000');if(!adm){const ac={phone:'0700000000',pin:'0000',balance:0,isAdmin:true,isSuspended:false,isBlocked:false,dateCreated:new Date().toISOString()};await su(ac);U.push(ac)}}catch(e){}});</script>
<style>*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif} :root{--primary:#00a651;--secondary:#00a651;--dark:#333;--light:#f5f5f5;--danger:#e74c3c;--success:#2ecc71;--warning:#f39c12;--info:#3498db} body{background:#f0f2f5;color:#333;line-height:1.6} .container{max-width:400px;margin:0 auto;padding:20px} .app-header{background:linear-gradient(to right,var(--primary),var(--secondary));color:#fff;padding:15px 0;text-align:center;border-radius:0 0 20px 20px;box-shadow:0 4px 12px rgba(0,0,0,.1)} .card{background:#fff;border-radius:12px;padding:20px;margin:20px 0;box-shadow:0 4px 12px rgba(0,0,0,.05)} .btn{display:block;width:100%;padding:12px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s;text-align:center;margin:10px 0} .btn-primary{background:var(--primary);color:#fff} .btn-outline{background:transparent;border:1px solid var(--primary);color:var(--primary)} .form-control{width:100%;padding:12px;border:1px solid #ddd;border-radius:8px;font-size:16px} .hidden{display:none} .nav-tabs{display:flex;justify-content:space-between} .menu-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}.menu-item{background:#fff;border-radius:10px;padding:12px;display:flex;align-items:center;gap:10px;box-shadow:0 2px 6px rgba(0,0,0,.05);text-align:center}.balance-card{background:#fff;border-radius:10px;padding:12px;margin:12px 0;text-align:center}.transaction-item,.transaction-admin-item,.user-item{background:#fff;border-radius:8px;padding:10px;margin:8px 0;display:flex;justify-content:space-between;align-items:center}.status-badge{padding:6px 8px;border-radius:8px;font-weight:600}.status-active{background:var(--success);color:#fff}.status-suspended{background:var(--warning);color:#fff}.status-blocked{background:var(--danger);color:#fff}.notification{position:fixed;left:50%;transform:translateX(-50%);bottom:20px;padding:12px 18px;border-radius:8px;background:#333;color:#fff;opacity:0;transition:all .25s}.notification.show{opacity:1}</style></body></html>